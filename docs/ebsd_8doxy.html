<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>EBSDpython: EBSD/ebsd.doxy File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%">
 <tbody>
 <tr style="height: 56px;">
  <td>
   <div id="projectname"> <!--EBSDpython--> <center> EBSDpython code </center>
    <!-- Version: 1--> 
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5bc23c883415a8b2d74bf6dce974927c.html">EBSD</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ebsd.doxy File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Tutorials for ebsd. </p>
<h1><a class="anchor" id="todo"></a>
TODO-list</h1>
<ul>
<li>What is the definition of the .crc fields, e.g. BC, BS,.. and the .org fields, e.g. CI, IQ, ...</li>
</ul>
<h1><a class="anchor" id="overview"></a>
Overview</h1>
<p>Features:</p>
<ul>
<li>File formats accepted .ang | .osc | .crc | .txt</li>
<li>fast plotting interaction using virtual mask (only used for plotting); even though some interpolation and reading takes time</li>
</ul>
<h1><a class="anchor" id="futureFeatures"></a>
Future features</h1>
<ul>
<li>improve cleaning, grain identification methods</li>
<li>add different symmetries than cubic, and test</li>
</ul>
<h1><a class="anchor" id="tutorials"></a>
Tutorials</h1>
<h2><a class="anchor" id="example1"></a>
Example: IPF map</h2>
<ul>
<li>plot confidence index (CI). Mask out all points with a CI less than 0.1. Initially all points are present in the mask, i.e. they are shown. By masking out points, these are removed from the mask.</li>
<li>plot inverse pole figure in normal direction</li>
<li>play with different options (1024pixel to see speed of plotting)</li>
<li>setVMask: for fast plotting;</li>
<li>pole figure (PF) in the [1,0,0] direction. The OIM software has the top left corner has coordinate origin</li>
</ul>
<pre class="fragment">&gt;&gt;&gt; from ebsd import EBSD
&gt;&gt;&gt; e = EBSD("Examples/EBSD.ang")
Load .ang file:  Examples/EBSD.ang
   Read file with step size: 0.2 0.2
   Optimal image pixel size: 103
   Number of points: 23909
&gt;&gt;&gt; e.plot(e.CI)
&gt;&gt;&gt; e.maskCI( 0.1 )
&gt;&gt;&gt; e.plot( e.CI )
&gt;&gt;&gt; e.plotIPF()
&gt;&gt;&gt; e.plotIPF(1024)
&gt;&gt;&gt; e.addScaleBar()
&gt;&gt;&gt; e.setVMask(4)                          # use only every 4th point, increases plotting speed
&gt;&gt;&gt; e.plotIPF(1024)
&gt;&gt;&gt; e.cropVMask(0,0,10,10)               # show only a section of the image, increases plotting speed
&gt;&gt;&gt; e.plotIPF(1024)
&gt;&gt;&gt; e.plotPF([1,0,0])
&gt;&gt;&gt; e.plotPF([1,0,0],points=True)</pre><div class="image">
<img src="ebsd_py_ND.png" alt="ebsd_py_ND.png"/>
</div>
<h2><a class="anchor" id="example2"></a>
Example: Interaction with OIM Software to update grain information from different file</h2>
<p>How to export txt-file from OIM that can be read:</p>
<ul>
<li>Partition-&gt;export-&gt; grain file -&gt; use "grain file type 1" (saves a txt file)</li>
<li>Partition-&gt;export-&gt; partition data -&gt; save as .ang</li>
</ul>
<p>Warning: This is example input file does not exist, anymore. Not tested </p>
<pre class="fragment">&gt; e = EBSD("Examples/Test.ang")
&gt; e.loadTXT("Examples/TestB.txt")
&gt; e.maskCI(0.1)
&gt; e.removePointsOfMask()
&gt; e.writeANG("ebsd.ang")</pre><p> Which can then be read in OIM again</p>
<h2><a class="anchor" id="example3"></a>
Example: calculate average orientation</h2>
<pre class="fragment">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from ebsd import EBSD
&gt;&gt;&gt; from ebsd_Orientation import Orientation
&gt;&gt;&gt; e = EBSD("Examples/EBSD.ang")
Load .ang file:  Examples/EBSD.ang
   Read file with step size: 0.2 0.2
   Optimal image pixel size: 103
   Number of points: 23909
&gt;&gt;&gt; e.maskCI( 0.001 )
&gt;&gt;&gt; e.plotIPF('ND')                        
&gt;&gt;&gt; e.cropVMask(xmin=18,ymin=12,ymax=17)
&gt;&gt;&gt; e.plotIPF('ND')                        </pre><p> Inspect the original data at x,y = 20.1,14.38 um <br/>
 line 8785 from EBSD.ang <br/>
 5.55763 2.18448 3.83349 20.10000 14.37602 3653.496 0.482 0 1 1.104 <br/>
 </p>
<pre class="fragment">&gt;&gt;&gt; print np.degrees([ 5.55763, 2.18448, 3.83349])
[ 318.4287431   125.16148443  219.64279781]
&gt;&gt;&gt; e.cropVMask(xmin=20,xmax=20.2,ymin=14.3,ymax=14.4)
&gt;&gt;&gt; e.y[e.vMask]                           #verify y: correct if rounding accounted for
array([ 14.37602043], dtype=float32)
&gt;&gt;&gt; angle = e.quaternions[e.vMask].asEulers().flatten()
&gt;&gt;&gt; print np.degrees(angle)                #convert to only positive values
[ -41.53981717  125.14032175 -140.35206827]
&gt;&gt;&gt; print np.degrees(angle)+np.array([360,0,360])
[ 318.46018283  125.14032175  219.64793173]</pre><p> Plot correct unit cells and pole-figures using the orientation-class </p>
<pre class="fragment">&gt;&gt;&gt; o = Orientation(Eulers=angle, symmetry="cubic")
&gt;&gt;&gt; o.toScreen()                                   #first item is one looking for
Euler angles: [ -41.5  125.1 -140.4]
HKL [0 1 0]
UVW [ 0  1 -1]
Equivalent orientations - Euler angles:
   [318.5  125.1  219.6]
   [138.5   54.9  320.4]
   [138.5   54.9  140.4]
   [318.5  125.1   39.6]
   [ 83.2  129.0  137.8]
   [263.2   51.0   42.2]
   [203.0  121.5  317.6]
   [ 23.0   58.5   42.4]
   [138.5   54.9   50.4]
   [138.5   54.9  230.4]
   [203.0  121.5  227.6]
   [ 83.2  129.0  227.8]
   [ 23.0   58.5  312.4]
   [203.0  121.5   47.6]
   [ 23.0   58.5  132.4]
   [263.2   51.0  312.2]
   [263.2   51.0  132.2]
   [ 83.2  129.0   47.8]
   [318.5  125.1  129.6]
   [318.5  125.1  309.6]
   [ 23.0   58.5  222.4]
   [203.0  121.5  137.6]
   [ 83.2  129.0  317.8]
   [263.2   51.0  222.2]
&gt;&gt;&gt; o.plot(plot2D='up-left')
&gt;&gt;&gt; o.plot(poles=[1,0,0],plot2D='up-left',scale=1.5)</pre><p> Create artificial ebsd pattern to check PF </p>
<pre class="fragment">&gt;&gt;&gt; e = EBSD('void318.|125.|219.6|0|2')
Void mode 318.|125.|219.6|0|2
   Euler angles: 5.55 2.18 3.83 | distribution: 0.0 | numberPerAxis: 2.0
   Read file with step size: 1.0 1.0
   Optimal image pixel size: 1
   Number of points: 4
&gt;&gt;&gt; e.plotPF(size=5)
&gt;&gt;&gt; e.plotPF(points=True)</pre><p> Finally, inspect pole-figure of data and compare OIM software, mTex and this python code </p>
<pre class="fragment">&gt;&gt;&gt; e = EBSD("Examples/EBSD.ang")
Load .ang file:  Examples/EBSD.ang
   Read file with step size: 0.2 0.2
   Optimal image pixel size: 103
   Number of points: 23909
&gt;&gt;&gt; e.maskCI( 0.001 )
&gt;&gt;&gt; e.plotPF(size=1)                       
&gt;&gt;&gt; e.plotPF()                 
&gt;&gt;&gt; e.plotPF(proj2D='down-right')</pre>  
<table border=1>
<tr><td><center>description</center></td>
  <td><center>OIM software</center></td>
  <td><center>mTex software</center></td>
  <td><center>this python code</center></td></tr>
<tr><td><center>IPF ND*</center> </td>
  <td><image src="HTMLInput/ebsd_OIM_ND.bmp"    height=300px></td>
  <td><image src="HTMLInput/ebsd_mTex_ND.png"   height=300px></td>
  <td><image src="HTMLInput/ebsd_py_ND.png"     height=300px></td></tr>
<tr><td><center>IPF RD</center> </td>
  <td><image src="HTMLInput/ebsd_OIM_RD.bmp"    height=300px></td>
  <td><center>I cannot produce</center></td>
  <td><image src="HTMLInput/ebsd_py_RD.png"     height=300px></td></tr>
<tr><td><center>PF [100]</center> </td>
  <td><image src="HTMLInput/ebsd_OIM_PF001.bmp"    height=200px></td>
  <td><image src="HTMLInput/ebsd_mTex_PF100_xNorthzOutOfPlane.png"   height=200px></td>
  <td><image src="HTMLInput/ebsd_py_PF100.png"     height=200px></td></tr>
<tr><td><center>PF [100] contour</center> </td>
  <td><center>I cannot produce</center></td>
  <td><image src="HTMLInput/ebsd_mTex_PF100Contour_xNorthzOutOfPlane.png"   height=200px></td>
  <td><image src="HTMLInput/ebsd_py_PF100Contour.png"     height=200px></td></tr>
<tr><td><center>PF [111]</center> </td>
  <td><image src="HTMLInput/ebsd_OIM_PF111.bmp"    height=200px></td>
  <td><image src="HTMLInput/ebsd_mTex_PF111_xNorthzOutOfPlane.png"   height=200px></td>
  <td><image src="HTMLInput/ebsd_py_PF111.png"     height=200px></td></tr>
</table>

Issues from mTex:
<ul>
<li>.bmp (left): low color number when exporting from external window. .png works (right)<br>
<image src="HTMLInput/ebsd_mTex_ND.bmp"   height=300px>
<image src="HTMLInput/ebsd_mTex_ND.png"   height=300px>
<li>Explicitly select x-axis as North and z-axis as outOfPlane; normal orientation has different result, although it should be the same<br>
<image src="HTMLInput/ebsd_mTex_PF100Contour_xNorthzOutOfPlane.png"   height=200px>
<image src="HTMLInput/ebsd_mTex_PF100Contour_org.png"   height=200px>
</ul>
<h2><a class="anchor" id="example4"></a>
Average orientation in file, does not make sence for this multi-grain case</h2>
<p>averaging takes lots of time: Orientation.average() </p>
<pre class="fragment">&gt;&gt;&gt; from ebsd_Orientation import Orientation
&gt;&gt;&gt; from ebsd import EBSD
&gt;&gt;&gt; Orients = []
&gt;&gt;&gt; e = EBSD("Examples/EBSD.ang")
Load .ang file:  Examples/EBSD.ang
   Read file with step size: 0.2 0.2
   Optimal image pixel size: 103
   Number of points: 23909
&gt;&gt;&gt; for i in range(len(e.x)):
...   Orients.append(Orientation(quaternion=e.quaternions[i], symmetry="cubic"))
&gt;&gt;&gt; avg = Orientation.average( Orients)
&gt;&gt;&gt; print "Average orientation",np.round(avg.asEulers(degrees=True, standardRange=True),2)
Average orientation [  79.12    9.81  281.32]</pre><h2><a class="anchor" id="compare"></a>
Compare the three software for bicrystal</h2>
 
<table border=1>
<tr><td><center>description</center></td>
  <td><center>OIM software</center></td>
  <td><center>mTex software</center></td>
  <td><center>this python code</center></td></tr>
<tr><td><center>IPF ND*</center> </td>
  <td><image src="HTMLInput/bc_OIM_ND.bmp"    width=300px></td>
  <td><image src="HTMLInput/bc_mTex_ND.png"   width=300px></td>
  <td><image src="HTMLInput/bc_py_ND.png"     width=300px></td></tr>
<tr><td><center>IPF RD</center> </td>
  <td><image src="HTMLInput/bc_OIM_RD_y.bmp"    width=300px></td>
  <td><center>I cannot produce</center></td>
  <td><image src="HTMLInput/bc_py_RD.png"     width=300px></td></tr>
<tr><td><center>PF [100]</center> </td>
  <td><image src="HTMLInput/bc_OIM_PF.bmp"    height=200px></td>
  <td><image src="HTMLInput/bc_mTex_PF.png"   height=200px></td>
  <td><image src="HTMLInput/bc_py_PF.png"     height=200px></td></tr>
</table>
<p>Python code </p>
<pre class="fragment">&gt;&gt;&gt; from ebsd import EBSD
&gt;&gt;&gt; e = EBSD("Examples/EBSD.ang")
Load .ang file:  Examples/EBSD.ang
   Read file with step size: 0.2 0.2
   Optimal image pixel size: 103
   Number of points: 23909
&gt;&gt;&gt; e.cropVMask(ymin=35)
&gt;&gt;&gt; e.plotIPF("ND",fileName="pythonND.png")
&gt;&gt;&gt; e.addSymbol(5,37, scale=2)
&gt;&gt;&gt; e.addSymbol(18,37, scale=2,fileName="pythonND.png")
&gt;&gt;&gt; e.plotIPF("RD",fileName="pythonRD.png")
&gt;&gt;&gt; e.addSymbol(5,37, scale=2)
&gt;&gt;&gt; e.addSymbol(18,37, scale=2,fileName="pythonRD.png")
&gt;&gt;&gt; e.plotIPF("TD",fileName="pythonTD.png")
&gt;&gt;&gt; e.addSymbol(5,37, scale=2)
&gt;&gt;&gt; e.addSymbol(18,37, scale=2,fileName="pythonTD.png")
&gt;&gt;&gt; e.plotPF(      fileName="pythonPF.png")</pre><p> please, note, the last image is not colored. This is not implemented yet. TODO</p>
<h1><a class="anchor" id="mTex"></a>
how to run mTex</h1>
<pre class="fragment">&gt;&gt; startup_mtex
&gt;&gt; import_wizard('ebsd')
% and select EBSD.osc
% select plotting convention 5: x-to-right; y-to-bottom
% select "convert Euler 2 Spacial Referecence Frame"
% save to workspace variable
&gt;&gt; csCopper = ebsd('Cu').CS;
&gt;&gt; plot(ebsd('Cu'),ebsd('Cu').orientations,'coordinates','on')
&gt;&gt; cS = crystalShape.cube(ebsd.CS)
&gt;&gt; region = [0 35 50 50];
&gt;&gt; ebsdC  = ebsd(inpolygon(ebsd,region))
&gt;&gt; plot(ebsdC('Cu'),ebsdC('Cu').orientations,'coordinates','on')
&gt;&gt; plotPDF(ebsd('Cu').orientations, Miller({1 0 0},csCopper))
% select xNorth zOutOfPlane as axis in mTex
&gt;&gt; plotPDF(ebsd('Cu').orientations, Miller({1 1 1},csCopper))
&gt;&gt; odf = calcODF(ebsd('Cu').orientations)
&gt;&gt; plotPDF(odf,Miller({1 0 0},csCopper) )
</pre><p>If separate window: save as png, because bmp colorscale is broken</p>
<ul>
<li>if not separet window: save as bmp, because png crops sections off select xNorth zOutOfPlane as axis in mTex</li>
<li>compare to original which should be the same</li>
</ul>
<h1><a class="anchor" id="data"></a>
Data that exists and can be used for plotting in plot:</h1>
<ul>
<li>OIM software:<ul>
<li>e.phi1, e.PHI, e.phi2 : Euler angles saved as quaternions</li>
<li>e.x, e.y : x,y coordinates</li>
<li>e.IQ, e.CI, e.phaseID : Image Quality, confidence index (bad=0 ... good=1) , phase id</li>
<li>e.SEMsignal : SEM signal</li>
<li>e.fit :</li>
</ul>
</li>
<li>Oxford:<ul>
<li>bc: band contrast</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="developerHints"></a>
Hints for developers</h1>
<ul>
<li>run ./verifyAll.py after all changes to verify the code and create the html-documentation</li>
<li>git commands<ul>
<li>git add -A</li>
<li>git gui</li>
<li>git commit -m "solved symbolic link issue"</li>
<li>git push -u origin master </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->

<hr class="footer"/><address class="footer"><small>
Copyright by Steffen Brinckmann
<!--Generated on Tue Nov 20 2018 15:59:19 for EBSDpython by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5 -->
</small></address>
</body>
</html>
